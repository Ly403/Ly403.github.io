<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> ç¦»æ•£å‹æµåŒ¹é…æ¨¡å‹ï¼ˆ2ï¼‰ | Yi Liu's Homepage. ğŸ˜€ </title> <meta name="author" content="Yi LIU"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?b05f9a0b7405d7c8c89c7465593dea81"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?dadeb9c5d1fd12bc8d37475657446863"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?1fefb6021bf36010f25ea1cef24af84e"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?53a094b51ed1d1e025731eb00d240058" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%8B&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ly403.github.io/blog/2025/%E7%A6%BB%E6%95%A3%E6%B5%81%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%9E%8B-2/"> <script src="/assets/js/theme.js?f2531f05c6f8e1622518f4f5a1e385b1"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?46af317e693b09921dcb92261d123fbc" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Yi Liu's Homepage. ğŸ˜€ </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/teaching/">teaching</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">ç¦»æ•£å‹æµåŒ¹é…æ¨¡å‹ï¼ˆ2ï¼‰</h1> <p class="post-meta"> Created on January 19, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> Â  Â· Â  <a href="/blog/tag/formatting"> <i class="fa-solid fa-hashtag fa-sm"></i> formatting</a> Â  <a href="/blog/tag/math"> <i class="fa-solid fa-hashtag fa-sm"></i> math</a> Â  Â· Â  <a href="/blog/category/flow-matching"> <i class="fa-solid fa-tag fa-sm"></i> Flow_Matching</a> Â  <a href="/blog/category/discrete-flow-matching"> <i class="fa-solid fa-tag fa-sm"></i> Discrete_Flow_Matching</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>æ¥ç€ä¸Šä¸€æ¬¡å­¦ä¹ çš„DFMçš„ä¸ŠåŠéƒ¨åˆ†ï¼Œè¿™æ¬¡å­¦ä¹ DFMçš„ä¸‹åŠéƒ¨åˆ†ã€‚ä¸»è¦è¿˜æ˜¯åŸºäºFlow Matching Guide and Code<sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>ã€‚</p> <h2 id="åˆ†è§£è·¯å¾„é€Ÿåº¦å’ŒæŸå¤±">åˆ†è§£è·¯å¾„ã€é€Ÿåº¦å’ŒæŸå¤±</h2> <p>åœ¨å®é™…å®ç°DFMçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæƒ³è¦åƒFM<sup id="fnref:2"><a href="#fn:2" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>ä¸€æ ·ç”¨ç¥ç»ç½‘ç»œé¢„æµ‹ä¸Šä¸€èŠ‚è¯´çš„æ¡ä»¶é€Ÿåº¦åœºï¼Œå³$u^{\theta}_t(y,x) = \mathbb{E}[u_t(y,X_t\mid Z )\mid X_t =x )]$ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿™æ ·åšï¼Œé‚£ä¹ˆç¥ç»ç½‘ç»œéœ€è¦å¤„ç†éå¸¸å¤šç§æƒ…å†µã€‚å…·ä½“è€Œè¨€ï¼Œå› ä¸º$y\in \mathcal{S}=\mathcal{T}^d$ï¼Œå…¶ä¸­$\mathcal{T} = {1,\cdots, K}$æ˜¯vocabularyï¼Œ$d$æ˜¯å¥å­é•¿åº¦ï¼Œæ‰€ä»¥ç¥ç»ç½‘ç»œè¾“å‡ºçš„å¤§å°ä¸º$K^d$ï¼ˆå¯¹ç¬¬ä¸€ä¸ªè¯è¦è€ƒè™‘$K$ä¸ªçŠ¶æ€ï¼Œå¯¹ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªç›´åˆ°ç¬¬$d$ä¸ªè¯éƒ½è¦è€ƒè™‘$K$ä¸ªçŠ¶æ€ï¼Œæ‰€ä»¥æ˜¯$K^d$ï¼‰ã€‚è¿™ä¹ˆå¤§çš„è¾“å‡ºå¤§å°æ˜¯ä¸å¯å®ç°çš„ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<strong>åˆ†è§£ï¼ˆfactorizedï¼‰<sup id="fnref:3"><a href="#fn:3" class="footnote" rel="footnote" role="doc-noteref">3</a></sup>æ–¹æ³•</strong>ã€‚</p> <p>ä¸‹é¢è¦é€ä¸ªä½¿ç”¨è¿™ç§æ–¹æ³•æ¥åˆ†è§£ï¼ˆè¾¹ç¼˜/æ¡ä»¶ï¼‰è·¯å¾„ã€ï¼ˆè¾¹ç¼˜/æ¡ä»¶ï¼‰é€Ÿåº¦å’Œæ¡ä»¶æŸå¤±ã€‚</p> <h3 id="åˆ†è§£è¾¹ç¼˜é€Ÿåº¦">åˆ†è§£è¾¹ç¼˜é€Ÿåº¦</h3> <p>åˆ†è§£æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³åœ¨äºï¼š<strong>åªè€ƒè™‘æœ€å¤šä¸€ä¸ªtokençš„æ”¹å˜</strong>ã€‚å› ä¸ºå¤šä¸ªtokençš„æ”¹å˜å¯ä»¥è§†ä¸ºé€ä¸ªtokençš„å•æ­¥å˜åŒ–çš„å åŠ ã€‚æ¢è®¨ä¸€ä¸ªtokençš„æ”¹å˜å°±åƒæ¢è®¨åŸºå˜æ¢ä¸€æ ·ã€‚</p> <p>åˆ†è§£è¾¹ç¼˜é€Ÿåº¦çš„å…·ä½“å½¢å¼æ˜¯ï¼š</p> \[u_t(y,x) = \sum_i \delta(y^{\bar{i}},x^{\bar{i}})u_t^i(y^i,x)\tag{1}\] <p>$\bar i = {1,\cdots, i-1,i+1,\cdots,d}$ï¼Œå°±æ˜¯æŠŠ$i$å»æ‰ï¼Œç›¸å½“äºåªè€ƒè™‘ç¬¬$i$ä¸ªtokençš„å˜åŒ–ã€‚åˆ†è§£è¾¹ç¼˜é€Ÿåº¦å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/post/DFM2-480.webp 480w,/assets/img/post/DFM2-800.webp 800w,/assets/img/post/DFM2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/post/DFM2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> åˆ†è§£è¾¹ç¼˜é€Ÿåº¦å›¾ç¤º </div> <p>ç°åœ¨æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨æ¨¡å‹é¢„æµ‹$u_t^{i}(y^i,x)$äº†ã€‚å…¶ä¸­ï¼Œ$i\in [d] = {1,\cdots,d}$ï¼Œ$y^i \in \mathcal{T}$æ˜¯ç¬¬$i$ä¸ªtokençŠ¶æ€æ”¹å˜åæ‰€åœ¨çš„çŠ¶æ€ï¼Œ$x\in \mathcal{S}$ä¸ºçŠ¶æ€è½¬ç§»ä¹‹å‰çš„å…¨éƒ¨tokençš„çŠ¶æ€ï¼Œ$u_t^i(y^i,x) \in \mathbb R$æ˜¯ä¸€ä¸ªæ ‡é‡é€Ÿç‡ã€‚æ‰€ä»¥ï¼Œ<strong>æ¨¡å‹è¦è¾“å‡ºçš„ç»“æœçš„ç»´åº¦æ˜¯$d\cdot K$ï¼ˆæ€»å…±$d$ä¸ªtokenï¼Œæ¯ä¸ªtokenæœ‰$K$ç§å¯ä»¥æ”¹å˜åˆ°çš„çŠ¶æ€ï¼Œå¯¹åº”$d\cdot K$ç§é€Ÿç‡ï¼‰ï¼Œç›¸æ¯”ä¹‹å‰çš„$K^d$å¤§å¤§å‡å°</strong>ã€‚</p> <p>åˆ†è§£çš„è¾¹ç¼˜é€Ÿç‡è¿˜æ˜¯è¦æ»¡è¶³é€Ÿç‡æ¡ä»¶ï¼Œä¸è¿‡æ˜¯è¦æŒ‰ç…§æ¯ä¸ªtokençš„å±‚çº§è¿›è¡Œæè¿°ï¼Œå¦‚ä¸‹ï¼š</p> \[u_t^i(y^i,x)\ge 0 \text{ for all } y^i \neq x^i \text{, and } \sum_{y^i \in \mathcal{T}}{u^i_t(y^i,x)} = 0 \quad \text{for all }x \in \mathcal{S} \tag{2}\] <p>$\forall i\in [d]$ï¼Œå…¬å¼ï¼ˆ2ï¼‰éƒ½è¦æ»¡è¶³ã€‚</p> <p>æ—¢ç„¶æˆ‘ä»¬æœ‰äº†åˆ†è§£è¾¹ç¼˜æ¦‚ç‡ï¼Œé‚£ä¹ˆé‡‡æ ·è¿‡ç¨‹ä¹Ÿå¯ä»¥coordinate-wiseï¼ˆé€ç»´ï¼‰åœ°è¿›è¡Œï¼Œä»£å…¥å…¬å¼ï¼ˆ1ï¼‰åˆ°CTMCæ¨¡å‹çš„è½¬ç§»æ ¸ä¹‹ä¸­ï¼Œå³ï¼š</p> \[\begin{aligned} \mathbb{P}(X_{t+h}=y\mid X_t = x)&amp;=\delta(y,x)+hu_t(y,x)+o(h)\\ &amp;\overset{ä»£å…¥å…¬å¼(1)}{=} \delta(y,x)+h\sum_i \delta(y^{\bar{i}},x^{\bar{i}})u_t^i(y^i,x)+o(h)\\ &amp;\overset{å…¬å¼(4)}{=} \prod_{i}\left[ \delta(y^i,x^i) + h u_t^i(y^i,x) +o(h) \right] \end{aligned} \tag{3}\] <blockquote> <p>å…¬å¼ï¼ˆ3ï¼‰ç¬¬äºŒä¸ªç­‰å·åŸºäºå¦‚ä¸‹ç­‰å¼ï¼š</p> \[\prod_i\left[ a^i + h b^i \right] = \prod_i a^i + h\sum_{i}\left(\prod_{j\neq i}a^j\right) b^i + o(h) \tag{4}\] <p>å–$a^i = \delta(y^i,x^i)$ï¼Œ$b^i = u_t^i(y^i,x)$ï¼ŒåŒæ—¶æ³¨æ„åˆ°$\prod_i \delta(y^i,x^i) = \delta(y,x)$ï¼Œå°±å¾—å‡ºäº†å…¬å¼ï¼ˆ3ï¼‰ä¸­ç¬¬äºŒä¸ªç­‰å·è¡¨ç¤ºçš„å…³ç³»ã€‚</p> </blockquote> <p>æ‰€ä»¥æˆ‘ä»¬è¿˜å¯ä»¥ç”¨åˆ†è§£è¾¹ç¼˜é€Ÿç‡å®šä¹‰ä¸€ä¸ªåˆ†è§£è½¬ç§»æ ¸ç”¨ä»¥é‡‡æ ·ï¼š</p> \[\begin{aligned} \mathbb{P}(X^i_{t+h}=y^i\mid X_t = x) &amp;=\delta(y^i,x^i) + h u_t^i(y^i,x) +o(h) \\ \mathbb{P}(X_{t+h}=y\mid X_t = x) &amp;=\prod_i\mathbb{P}(X^i_{t+h}=y^i\mid X_t = x) \end{aligned}\tag{5}\] <p>é‡‡æ ·æ–¹æ³•è¿˜æ˜¯å¯ä»¥ç”¨CTMCæ¨¡å‹é‡Œé¢è¯´è¿‡çš„Euleræ³•ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯per coordinateçš„é‡‡æ ·ï¼Œå³æ¯ä¸€ç»´å•ç‹¬è¿›è¡Œé‡‡æ ·ã€‚</p> <p>å…¶å®FMçš„é‡‡æ ·ä¹Ÿå¯ä»¥å†™æˆç±»ä¼¼çš„åˆ†è§£çš„å½¢å¼ï¼Œä½†ä¸€èˆ¬ä¸è¿™ä¹ˆç”¨ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼š<strong>FMçš„é‡‡æ ·æ˜¯ç¡®å®šæ€§çš„ï¼Œè€ŒDFMçš„é‡‡æ ·å…·æœ‰éšæœºæ€§</strong>ã€‚</p> <h3 id="åˆ†è§£è¾¹ç¼˜æ¦‚ç‡è·¯å¾„">åˆ†è§£è¾¹ç¼˜æ¦‚ç‡è·¯å¾„</h3> <p>ä¸Šé¢æˆ‘ä»¬å·²ç»å®ç°äº†åˆ†è§£è¾¹ç¼˜é€Ÿåº¦ï¼Œç°åœ¨è€ƒè™‘ç”¨ä¸€æ ·çš„æ–¹æ³•åˆ†è§£è¾¹ç¼˜æ¦‚ç‡è·¯å¾„$q_t(x)$ï¼š</p> \[q_t(x) = \prod_{i}q_t^i(x^i)\tag{6}\] <p>å…¶ä¸­ï¼Œ$q_t^i(x^i)$å°±æ˜¯åˆ†è§£åçš„è¾¹ç¼˜æ¦‚ç‡è·¯å¾„ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬æƒ³è¯´æ˜ï¼š<strong>åˆ†è§£è¾¹ç¼˜é€Ÿç‡ç”Ÿæˆåˆ†è§£è¾¹ç¼˜æ¦‚ç‡è·¯å¾„æ—¶ï¼Œéåˆ†è§£çš„è¾¹ç¼˜é€Ÿç‡ä¹Ÿèƒ½ç”Ÿæˆéåˆ†è§£çš„è¾¹ç¼˜æ¦‚ç‡è·¯å¾„</strong>ï¼Œä¹Ÿå°±æ˜¯å¸Œæœ›è¾¹ç¼˜é€Ÿç‡å’Œè¾¹ç¼˜æ¦‚ç‡è·¯å¾„çš„å…³ç³»åœ¨åˆ†è§£å’Œéåˆ†è§£å½¢å¼ä¸‹éƒ½ä¿ç•™ã€‚å…·ä½“è€Œè¨€å°±æ˜¯å¦‚ä¸‹å‘½é¢˜ï¼š</p> <p><strong>å‘½é¢˜2</strong> ä»¤$q_t(x)$ç”±å…¬å¼ï¼ˆ6ï¼‰æ‰€ç¤ºçš„åˆ†è§£å½¢å¼å®šä¹‰ï¼Œå½“$u_t^i(y^i,x^i)\in C([0,1))$èƒ½å¤Ÿç”Ÿæˆ$q_t^i(x^i)$æ—¶ï¼Œé‚£ä¹ˆ$q_t$ç”±å¦‚ä¸‹åˆ†è§£å½¢å¼çš„è¾¹ç¼˜é€Ÿç‡ç”Ÿæˆï¼š</p> \[u_t(y,x)=\sum_i\delta(y^{\bar i},x^{\bar i})u_t^i(y^i,x^i) \tag{7}\] <blockquote> <p>å‘½é¢˜2çš„è¯æ˜å¦‚ä¸‹ï¼š</p> <p>é¦–å…ˆæ ¹æ®è¾¹ç¼˜æ¦‚ç‡çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$x^i$å’Œ$x^{\bar i}$çš„è¾¹ç¼˜æ¦‚ç‡å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è®¡ç®—ï¼ˆå°±æ˜¯æŠŠæ— å…³çš„å˜é‡æ±‚å’Œæ‰ï¼‰ï¼š</p> \[q^i(x^i) := \sum_{x^{\bar i}}q(x) \quad q^{\bar i }(x^{\bar i }) :=\sum_{x^i} q(x) \tag{8}\] <p>æ¨å¯¼å¦‚ä¸‹ï¼š</p> \[\begin{aligned} \cfrac{\mathrm{d}}{\mathrm{d}t}q_t(y) &amp;\overset{ä»£å…¥å…¬å¼(6)}{=} \cfrac{\mathrm{d}}{\mathrm{d}t}\prod_i q_t^i(y^i)\\ &amp;\overset{ä¹˜æ³•æ±‚å¯¼æ³•åˆ™}{=} \sum_i q^{\bar i}_t(y^{\bar i}) \cfrac{\mathrm{d}}{\mathrm{d}t}q_t^i(y^i)\\ &amp;\overset{\text{Kolmogorov}æ–¹ç¨‹}{=} \sum_i q^{\bar i}_t(y^{\bar i}) \left[ \sum_{x^i} u_t^i(y^i,x^i)q_t^i(x^i) \right]\\ &amp;\overset{(*)}{=} \sum_i \left[ \sum_{x^{\bar i}}\delta(y^{\bar i}, x^{\bar i} ) q_t^{\bar i}(x^{\bar i}) \right] \left[ \sum_{x^i} u_t^i(y^i,x^i)q_t^i(x^i) \right]\\ &amp;\overset{åˆ†é…å¾‹}{=} \sum_i \sum_{x^{\bar i}}\sum_{x^i} \left[ \delta(y^{\bar i}, x^{\bar i} ) q_t^{\bar i}(x^{\bar i}) u_t^i(y^i,x^i)q_t^i(x^i) \right]\\ &amp;\overset{åˆå¹¶x^iå’Œx^{\bar i}}{=} \sum_i \sum_{x} \left[ \delta(y^{\bar i}, x^{\bar i} ) u_t^i(y^i,x^i)q_t(x) \right]\\ &amp;\overset{äº¤æ¢æ±‚å’Œé¡ºåº}{=} \sum_{x}\left[\sum_i \left[ \delta(y^{\bar i}, x^{\bar i} ) u_t^i(y^i,x^i) \right]q_t(x)\right]\\ \end{aligned} \tag{9}\] <p>ï¼ˆ*ï¼‰å¼åŸºäº$q_t^{\bar i }(y^{\bar i}) = \sum_{x^{\bar i}}\delta(y^{\bar i}, x^{\bar i})q_t^{\bar i}(x^{\bar i})$ã€‚æ ¹æ®æœ€åç»“æœï¼Œå¯¹æ¯”Kolmogorovæ–¹ç¨‹ï¼Œå°±çŸ¥é“$u_t(y,x)=\sum_i\delta(y^{\bar i},x^{\bar i})u_t^i(y^i,x^i)$äº†ã€‚</p> </blockquote> <h3 id="åˆ†è§£æ¡ä»¶é€Ÿç‡å’Œæ¡ä»¶æ¦‚ç‡è·¯å¾„">åˆ†è§£æ¡ä»¶é€Ÿç‡å’Œæ¡ä»¶æ¦‚ç‡è·¯å¾„</h3> <p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦åˆ†è§£æ¡ä»¶é€Ÿç‡å’Œæ¡ä»¶æ¦‚ç‡è·¯å¾„ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°åˆ†è§£ç‰ˆçš„ç¦»æ•£è¾¹ç¼˜åŒ–æŠ€å·§ï¼ˆDiscrete Factorized Marginalization Trickï¼‰ã€‚</p> <p><strong>å®šç†16</strong>ï¼ˆDiscrete Factorized Marginalization Trickï¼‰è€ƒè™‘ä¸€ä¸ªè¾¹ç¼˜æ¦‚ç‡è·¯å¾„é€šè¿‡å¦‚ä¸‹æ–¹å¼æ„é€ ï¼š</p> \[p_t(x) =\sum_z p_{t\mid Z}(x \mid z) p_Z(z)\text{, with }p_{t\mid Z}(x\mid z)= \prod_ip_{t\mid Z}^i(x^i\mid z)\tag{10}\] <p>å…¶ä¸­ï¼Œ$p_{t\mid Z}^i(x^i\mid z)$æ˜¯åˆ†è§£æ¡ä»¶æ¦‚ç‡è·¯å¾„ï¼Œå°±åƒå…¬å¼ï¼ˆ6ï¼‰ä¸­çš„åˆ†è§£è¾¹ç¼˜æ¦‚ç‡è·¯å¾„ä¸€æ ·ã€‚</p> <p>å‡è®¾ï¼š$\forall x \in \mathcal{S}, \forall t\in[0,1)$ï¼Œ $p_t(x) &gt; 0$ã€‚<strong>åˆ†è§£æ¡ä»¶é€Ÿç‡$u_t^{i}(y^i, x^i \mid z) \in C([0,1))$<font color="red">ç”Ÿæˆ</font>åˆ†è§£æ¡ä»¶æ¦‚ç‡è·¯å¾„$p_{t\mid Z}^i(x^i\mid z) \in C^1([0,1))$ã€‚</strong></p> <p><strong>å‡è®¾æ»¡è¶³æ—¶ï¼Œè¾¹ç¼˜é€Ÿç‡</strong></p> \[u_t(y,x) =\sum_i\delta(y^{\bar i},x^{\bar i})u_t^i(y^i,x)\tag{11}\] <p><strong><font color="red">ç”Ÿæˆ</font>è¾¹ç¼˜æ¦‚ç‡è·¯å¾„$p_t(x)$ã€‚</strong></p> <p>å…¶ä¸­</p> \[u_t^i(y^i,x)=\sum_z u_t^i(y^i,x^i\mid z)p_{Z\mid t}(z\mid x) = \mathbb{E} \left[ u_t^i(y^i,X_t^i\mid Z) \mid X_t = x \right]\tag{12}\] <blockquote> <p>å®šç†16çš„è¯æ˜å¦‚ä¸‹</p> \[\begin{aligned} u_t(y,x) &amp;\overset{(*)}{=}\sum_z u_t(y,x\mid z)p_{Z\mid t}(z\mid x)\\ &amp;\overset{å…¬å¼(7)}{=}\sum_z \left[ \sum_i\delta(y^{\bar i},x^{\bar i})u_t^i(y^i,x^i\mid z) \right] p_{Z\mid t}(z\mid x)\\ &amp;\overset{äº¤æ¢æ±‚å’Œé¡ºåº}{=}\sum_i \delta(y^{\bar i},x^{\bar i}) \underbrace{\left[ \sum_z u_t^i(y^i,x^i\mid z) p_{Z\mid t}(z\mid x) \right]}_{u_t^i(y^i,x)} \\ \end{aligned} \tag{13}\] <p>ï¼ˆ*ï¼‰æ­¥æ˜¯æˆ‘ä»¬åœ¨DFMä¸Šä¸€èŠ‚<sup id="fnref:4"><a href="#fn:4" class="footnote" rel="footnote" role="doc-noteref">4</a></sup>ä¸­å·²ç»å¾—åˆ°çš„ç»“è®ºã€‚</p> <p>é‚£ä¹ˆæ ¹æ®ï¼ˆ13ï¼‰å¼ï¼Œå°±çŸ¥é“å…¬å¼ï¼ˆ11ï¼‰å’Œï¼ˆ12ï¼‰äº†ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜è¦è¯´æ˜<strong>å…¬å¼ï¼ˆ11ï¼‰è¡¨ç¤ºçš„è¾¹ç¼˜é€Ÿç‡èƒ½å¤Ÿ<font color="red">ç”Ÿæˆ</font>è¾¹ç¼˜æ¦‚ç‡è·¯å¾„$p_t(x)$</strong>ï¼Œè¿™éœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¸Šä¸€èŠ‚<sup id="fnref:4:1"><a href="#fn:4" class="footnote" rel="footnote" role="doc-noteref">4</a></sup>è®²çš„ç¦»æ•£è¾¹ç¼˜åŒ–æŠ€å·§ï¼Œç¦»æ•£è¾¹ç¼˜åŒ–æŠ€å·§æœ‰ä½¿ç”¨çš„å‡è®¾ï¼Œå³ $p_{t\mid Z}(x\mid z)\in C^{1}([0,1))$ï¼Œ$u_t(y,x\mid z)\in C([0,1))$ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥è¯´æ˜è¿™ä¸ªå‡è®¾èƒ½æ»¡è¶³ã€‚</p> <p>æ ¹æ®å®šç†16çš„å‡è®¾å¯çŸ¥$p_{t\mid Z}^i(x^i\mid z) \in C^1([0,1))$ï¼Œ$\forall t \in C([0,1)), p_t(x) &gt; 0$ï¼Œæ‰€ä»¥æ ¹æ®$p_{t\mid Z}(x\mid z)=\prod_ip_{t\mid Z}^i(x^i\mid z)$å¯çŸ¥$p_{t\mid Z}(x\mid z)\in C^1([0,1))$ã€‚æ ¹æ®å®šç†16çš„å‡è®¾å¯çŸ¥$u_t^{i}(y^i, x^i \mid z) \in C([0,1))$ï¼Œæ ¹æ®å…¬å¼7æˆ‘ä»¬çŸ¥é“$u_t(y,x\mid z)=\sum_i\delta(y^{\bar i},x^{\bar i})u_t^i(y^i,x^i\mid z)$ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“$u_t(y,x\mid z)\in C([0,1))$ã€‚</p> <p>æ‰€ä»¥ç¦»æ•£è¾¹ç¼˜åŒ–æŠ€å·§å‡è®¾æ»¡è¶³ï¼Œå¯ä»¥åº”ç”¨è¯¥æŠ€å·§ï¼Œå¾—å‡º</p> <p><strong>å…¬å¼ï¼ˆ11ï¼‰è¡¨ç¤ºçš„è¾¹ç¼˜é€Ÿç‡$u_t(y,x)$èƒ½å¤Ÿ<font color="red">ç”Ÿæˆ</font>è¾¹ç¼˜æ¦‚ç‡è·¯å¾„$p_t(x)$</strong>ã€‚</p> <p>æ‰€ä»¥ï¼Œå®šç†16å¾—åˆ°è¯æ˜ã€‚</p> </blockquote> <h3 id="åˆ†è§£æ¡ä»¶æŸå¤±å‡½æ•°">åˆ†è§£æ¡ä»¶æŸå¤±å‡½æ•°</h3> <p>æˆ‘ä»¬å¯ä»¥è®©æ¨¡å‹é¢„æµ‹åˆ†è§£å½¢å¼çš„é€Ÿç‡$u_t^{\theta,i}$ï¼Œæ›¿ä»£åŸå…ˆé¢„æµ‹éåˆ†è§£å½¢å¼é€Ÿç‡$u_t^{\theta}$çš„å½¢å¼ï¼Œé‚£ä¹ˆæ¡ä»¶æŸå¤±å‡½æ•°çš„å½¢å¼å¯ä»¥æ”¹å†™ä¸ºï¼š</p> \[L_{CDFM}(\theta) = \mathbb{E}_{t,Z,X_t\sim p_{t\mid Z}} \sum_i D_{X_t}^i \left( u_t^i(\cdot,X_t \mid Z), u_t^{\theta,i}(\cdot, X_t) \right) \tag{14}\] <p>å…¶ä¸­ï¼Œ$t\in U[0,1]$ï¼Œ$u_t^{i}(\cdot,x\mid z), u_t^{\theta,i}(\cdot,x) \in \mathbb{R}^{\mathcal{T}}$ã€‚$u_t^{i}(\cdot,x\mid z),u_t^{\theta,i}(\cdot,x)$éœ€è¦æ»¡è¶³é€Ÿç‡æ¡ä»¶ã€‚$D_{x}^i(u,v)$æ˜¯åˆ†è§£åçš„Bregmanæ•£åº¦ã€‚</p> <blockquote> <p>å…³äº$u_t^{i}(\cdot,x\mid z),u_t^{\theta,i}(\cdot,x)$æ»¡è¶³é€Ÿç‡æ¡ä»¶ï¼Œå¯ä»¥ç”¨æ›´å½¢å¼åŒ–çš„æ–¹å¼è¡¨è¾¾ï¼š</p> <p>å®šä¹‰ï¼š å¯¹äº$\alpha \in \mathcal{T}$ï¼Œ</p> \[\Omega_{\alpha} = \left\{ v \in \mathbb{R}^{\mathcal{T}}\mid v(\beta)\ge 0 \text{ }\forall\beta \in \mathcal{T}\backslash \{\alpha\}\text{, and } v(\alpha) = -\sum_{\beta\neq \alpha} v(\beta) \right\} \subset \mathbb{R}^{\mathcal{T}}\tag{15}\] <p>$\Omega_{\alpha}$æ˜¾ç„¶æ˜¯ä¸ªå‡¸é›†åˆã€‚</p> <p>å½¢å¼åŒ–çš„è¯´ï¼Œ$u_t^{i}(\cdot,x\mid z),u_t^{\theta,i}(\cdot,x)$æ»¡è¶³é€Ÿç‡æ¡ä»¶ï¼Œå°±æ˜¯$u_t^{i}(\cdot,x\mid z),u_t^{\theta,i}(\cdot,x)\in \Omega_{x^i}$ã€‚</p> <p>å…³äº$D_{x}^i(u,v)$ï¼Œåœ¨<sup id="fnref:4:2"><a href="#fn:4" class="footnote" rel="footnote" role="doc-noteref">4</a></sup>ä¸­è¯´è¿‡ï¼Œå®ƒéœ€è¦ä¸€ä¸ªå‡¸å‡½æ•°æ¥å®šä¹‰ã€‚ä¸è¿‡ç›¸æ¯”äºéåˆ†è§£çš„$D_x(u,v)$ï¼Œ$D_{x}^i(u,v)$éœ€è¦çš„ä¹Ÿæ˜¯ä¸€ä¸ªåˆ†è§£çš„å‡¸å‡½æ•°ï¼Œå¯ä»¥è®°ä¸º$\Phi_x^i : \Omega_{x^i} \to \mathbb R$ã€‚</p> </blockquote> <hr> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1"> <p>Lipman Y, Havasi M, Holderrieth P, et al. Flow Matching Guide and Code[J]. arXiv preprint arXiv:2412.06264, 2024.Â <a href="#fnref:1" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> <li id="fn:2"> <p>Lipman Y, Chen R T Q, Ben-Hamu H, et al. Flow matching for generative modeling[J]. arXiv preprint arXiv:2210.02747, 2022.Â <a href="#fnref:2" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> <li id="fn:3"> <p>Campbell A, Benton J, De Bortoli V, et al. A continuous time framework for discrete denoising models[J]. Advances in Neural Information Processing Systems, 2022, 35: 28266-28279.Â <a href="#fnref:3" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> <li id="fn:4"> <p><a href="https://zhuanlan.zhihu.com/p/16493879333" rel="external nofollow noopener" target="_blank">https://zhuanlan.zhihu.com/p/16493879333</a>Â <a href="#fnref:4" class="reversefootnote" role="doc-backlink">â†©</a>Â <a href="#fnref:4:1" class="reversefootnote" role="doc-backlink">â†©<sup>2</sup></a>Â <a href="#fnref:4:2" class="reversefootnote" role="doc-backlink">â†©<sup>3</sup></a></p> </li> </ol> </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/%E7%A6%BB%E6%95%A3%E6%B5%81%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%9E%8B-3/">ç¦»æ•£å‹æµåŒ¹é…æ¨¡å‹ï¼ˆ3ï¼‰</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/%E7%A6%BB%E6%95%A3%E6%B5%81%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%9E%8B-1/">ç¦»æ•£å‹æµåŒ¹é…æ¨¡å‹ï¼ˆ1ï¼‰</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/%E8%BF%9E%E7%BB%AD%E6%97%B6%E9%97%B4%E7%9A%84%E9%A9%AC%E5%8F%AF%E5%A4%AB%E9%93%BE/">è¿ç»­æ—¶é—´çš„é©¬å¯å¤«é“¾</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 Yi LIU. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?c999e8c5281874b7534e3352f835d4c3" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?b977fe0c21b2118ed853308b1b923969"></script> <script src="/assets/js/no_defer.js?699fa7cbe3b29f831db7d5250ba3203a"></script> <script defer src="/assets/js/common.js?d3a25b46bbd2e0a751a27b173abc6e5f"></script> <script defer src="/assets/js/copy_code.js?fff63901a03063094790ffbfd4bc0cb4" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?25eff8ff4144a010e4ad7b31403102cf"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?04761245f225e3ad9e5e3f875d4e1074"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?b78cb42895d74e4fd6de6f633edcf181" type="text/javascript"></script> <script src="/assets/js/tabs.min.js?b3298908ffcca362ac4f3e3a7a7ebe94"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?230637657ac0b42e92d76e2b4c1b4764"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?ade73d6d60912d119f9c9347bc176630"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?f74bfa9a88ab862fb9df1c46146b7b7d"></script> </body> </html>